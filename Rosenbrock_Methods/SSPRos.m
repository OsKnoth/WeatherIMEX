function SSPRos
global A Ahat b bhat c chat r
%L-stable Rosenbrock-W method with SSP explicit part, third order, four stages By default, the Jacobian is only recomputed once per step.
%L-stable (A-stable embedded) SPP explicit order 3, 4 stages, CFL 2 (eff = 1/2)
r=5;
ARos = zeros(r,r);
ARos(2,1)=0.8717330430169179988320388950590125027645343373957631;
ARos(3,1)=0.5275890119763004115618079766722914408876108660811028;
ARos(3,2)=0.07241098802369958843819203208518599088698057726988732;
ARos(4,1)=0.3990960076760701320627260685975778145384666450351314;
ARos(4,2)=-0.4375576546135194437228463747348862825846903771419953;
ARos(4,3)=1.038461646937449311660120300601880176655352737312713;
ARos(5,1)=0.1876410243467238251612921333138006734899663569186926;
ARos(5,2)=-0.5952974735769549480478230473706443582188442040780541;
ARos(5,3)=0.9717899277217721234705114616271378792182450260943198;
ARos(5,4)=0.4358665215084589994160194475295062513822671686978816;

Gamma=zeros(r-1,r-1);
Gamma(1,1)=0.4358665215084589994160194475295062513822671686978816;
Gamma(2,1)=-1.997527830934941248426324674704153457289527280554476;
Gamma(2,2)=0.4358665215084589994160194475295062513822671686978816;
Gamma(3,1)=-1.007948511795029620852002345345404191008352770119903;
Gamma(3,2)=-0.004648958462629345562774289390054679806993396798458131;
Gamma(3,3)=0.4358665215084589994160194475295062513822671686978816;
Gamma(4,1)=-0.6685429734233467180451604600279552604364311322650783;
Gamma(4,2)=0.6056625986449338476089525334450053439525178740492984;
Gamma(4,3)=-0.9717899277217721234705114616271378792182450260943198;
Gamma(4,4)=0;
%Gamma(4,4)=0.4358665215084589994160194475295062513822671686978816;

AL=ARos(2:end,1:end-1);
A=ARos;
AIU=AL*Gamma*inv(AL);
AI=[zeros(1,r)
    zeros(r-1,1) AIU];
%Ahat=AI+A;
Ahat=AI;
b=A(r,:)';
c=A*ones(r,1);
bhat=Ahat(r,:)';
chat=Ahat*ones(r,1);


%     r = 6; coefa1 = 1/5; coefa2 = 1/5; coefa3 = 1/3; coefa4 = 1/2; coefa5 = 1;
%     A = [0 0 0 0 0 0 ; ...
%          coefa1 0 0 0 0 0 ; ...
%          0 coefa2 0 0 0 0 ; ...
%          0 0 coefa3 0 0 0 ; ...
%          0 0 0 coefa4 0 0 ; ...
%          0 0 0 0 coefa5 0];
%     c = A*ones(r,1); b = A(r,:)';
%     
%     ahat1 = 0; 
%     dhat1 = coefa1;
%     
%     ahat2 = 0; 
%     dhat2 = coefa2;
%     
%     ahat3 = 0; 
%     dhat3 = coefa3;
%     
%     ahat4 = 0; 
%     dhat4 = coefa4;
% 
%     eps = 1/18;
%     ahat51 = 1/2-4*eps; 
%     ahat52 = 5*eps;
%     dhat5 = 1/2 - eps;
% 
%     Ahat = [ 0 0 0 0 0 0 ; ahat1 dhat1 0 0 0 0 ; ahat2 0 dhat2 0 0 0 ; ...
%              ahat3 0 0 dhat3 0 0 ; ahat4 0 0 0 dhat4 0 ; ...
%              ahat51 ahat52 0 0 0 dhat5];
%     chat = Ahat*ones(r,1); bhat = Ahat(r,:)';
end
